import{L as _,T as C,o as L}from"./assets/main-DqUcE1Pw.js";import"./assets/vendor-CN01XXcz.js";document.addEventListener("DOMContentLoaded",async function(){const d=document.querySelector(".my-library-movie-list"),r=document.querySelector(".my-library-button.load"),g=document.querySelector(".my-library-sorry"),y=document.querySelector(".my-library-main-section"),a=document.querySelector("#genre"),i=document.querySelector("#my-library-button-search"),h=new _("myLibrary"),v=new C,u=document.getElementById("loader-library");let l=0;const m=12,b=new Map;async function w(){try{(await v.getMovieGenres()).forEach(t=>{t.id&&t.name&&b.set(t.id,t.name)}),E()}catch(e){console.error("Error fetching genres:",e)}}function E(){if(!a.querySelector('option[value=""]')){const e=document.createElement("option");e.value="",e.textContent="Genre",e.disabled=!0,e.selected=!0,a.appendChild(e)}b.forEach((e,t)=>{const n=document.createElement("option");n.value=t,n.textContent=e,a.appendChild(n)})}function q(e){const n=window.innerWidth<=600?1:2;return e.slice(0,n).map(s=>b.get(s)||"Unknown").join(", ")}function I(e){const n=Math.floor(e/2),s=e%2>=1?1:0,o=5-n-s;return[...Array(n).fill('<svg class="star full"><use xlink:href="#icon-star"></use></svg>'),...Array(s).fill('<svg class="star half"><use xlink:href="#icon-star-half"></use></svg>'),...Array(o).fill('<svg class="star empty"><use xlink:href="#icon-star-outline"></use></svg>')].join("")}function S(e){const t=document.createElement("li");t.classList.add("my-library-movie-list-item");const n=q(e.genre_ids||[]),s=e.id,o=e.release_date?new Date(e.release_date).getFullYear():"Unknown",c=Math.round(e.vote_average*10)/10,p=I(c),f=`https://image.tmdb.org/t/p/w500${e.poster_path}`;return t.style.backgroundImage=`url(${f})`,t.style.backgroundSize="cover",t.style.backgroundPosition="center",t.dataset.id=s,t.innerHTML=`
      <div class="my-library-gradient"></div>
      <div class="my-library-movie">
        <h2>${e.title}</h2>
        <p>${n} | ${o} <span class="stars">${p}</span></p>
      </div>
    `,t.addEventListener("click",()=>{L(e.id)}),t}async function D(e){try{const t=await v.getMovieDetails(e.id);return t&&t.genres&&(e.genre_ids=t.genres.map(n=>n.id)),t}catch(t){return console.error(`Failed to fetch details for movie ID ${e.id}:`,t),null}}async function k(e){for(const t of e)t.genre_ids||await D(t)}async function T(e="",t=!0){const n=h.getMovies();t&&(l=0,d.innerHTML=""),await k(n);const s=e?n.filter(o=>o.genre_ids&&o.genre_ids.includes(parseInt(e))):n;s.length>0?(y.style.display="block",document.querySelector(".genre-form").style.display="block",s.slice(l,l+m).forEach(c=>{const p=S(c);u.style.display="none",d.appendChild(p)}),l+=m,l>=s.length?r.style.display="none":r.style.display="block",i.style.display="none",i.disabled=!0):(u.style.display="none",g.style.display="block",y.style.display="none",document.querySelector(".genre-form").style.display="none",r.style.display="none",i.style.display="block",i.disabled=!1),document.querySelectorAll(".my-library-movie-list-item").forEach(o=>{o.addEventListener("click",c=>{const f=c.currentTarget.dataset.id;f&&L(f)})})}async function M(e=!0){const t=document.getElementById("loader-library");t.style.display="block";const n=h.getMovies();if(e&n.length===0){t.style.display="none",l=0,d.innerHTML="",g.style.display="block",r.style.display="none",y.style.display="none",document.querySelector(".genre-form").style.display="none",i.style.display="block",i.disabled=!1;return}else t.style.display="none",g.style.display="none",y.style.display="block",document.querySelector(".genre-form").style.display="block",i.style.display="none",i.disabled=!0;await k(n);for(const s of n.slice(l,l+m)){const o=S(s);d.appendChild(o)}l+=m,l>=n.length?r.style.display="none":r.style.display="block"}r.addEventListener("click",()=>{r.style.display="none",u.style.display="block",setTimeout(()=>{u.style.display="none",M(!1)},300)}),a.addEventListener("change",function(){const e=a.value;T(e)}),await w(),M()});
//# sourceMappingURL=library.js.map
