import{L as _,T as C,o as L}from"./assets/main-BTS95jxs.js";import"./assets/vendor-CTT6gwRZ.js";document.addEventListener("DOMContentLoaded",async function(){const y=document.querySelector(".my-library-movie-list"),r=document.querySelector(".my-library-button.load"),g=document.querySelector(".my-library-sorry"),u=document.querySelector(".my-library-main-section"),c=document.querySelector("#genre"),i=document.querySelector("#my-library-button-search"),h=new _("myLibrary"),v=new C,a=document.getElementById("loader-library");let o=0;const m=12,b=new Map;async function w(){try{(await v.getMovieGenres()).forEach(t=>{t.id&&t.name&&b.set(t.id,t.name)}),E()}catch(e){console.error("Error fetching genres:",e)}}function E(){if(!c.querySelector('option[value=""]')){const e=document.createElement("option");e.value="",e.textContent="Genre",e.disabled=!0,e.selected=!0,c.appendChild(e)}b.forEach((e,t)=>{const n=document.createElement("option");n.value=t,n.textContent=e,c.appendChild(n)})}function q(e){const n=window.innerWidth<=600?1:2;return e.slice(0,n).map(s=>b.get(s)||"Unknown").join(", ")}function I(e){const n=Math.floor(e/2),s=e%2>=1?1:0,l=5-n-s;return[...Array(n).fill('<svg class="star full"><use xlink:href="#icon-star"></use></svg>'),...Array(s).fill('<svg class="star half"><use xlink:href="#icon-star-half"></use></svg>'),...Array(l).fill('<svg class="star empty"><use xlink:href="#icon-star-outline"></use></svg>')].join("")}function S(e){const t=document.createElement("li");t.classList.add("my-library-movie-list-item");const n=q(e.genre_ids||[]),s=e.id,l=e.release_date?new Date(e.release_date).getFullYear():"Unknown",d=Math.round(e.vote_average*10)/10,p=I(d),f=`https://image.tmdb.org/t/p/w500${e.poster_path}`;return t.style.backgroundImage=`url(${f})`,t.style.backgroundSize="cover",t.style.backgroundPosition="center",t.dataset.id=s,t.innerHTML=`
      <div class="my-library-gradient"></div>
      <div class="my-library-movie">
        <h2>${e.title}</h2>
        <p>${n} | ${l} <span class="stars">${p}</span></p>
      </div>
    `,t.addEventListener("click",()=>{L(e.id)}),t}async function D(e){try{const t=await v.getMovieDetails(e.id);return t&&t.genres&&(e.genre_ids=t.genres.map(n=>n.id)),t}catch(t){return console.error(`Failed to fetch details for movie ID ${e.id}:`,t),null}}async function M(e){for(const t of e)t.genre_ids||await D(t)}async function T(e="",t=!0){const n=h.getMovies();t&&(o=0,y.innerHTML=""),await M(n);const s=e?n.filter(l=>l.genre_ids&&l.genre_ids.includes(parseInt(e))):n;s.length>0?(u.style.display="block",document.querySelector(".genre-form").style.display="block",s.slice(o,o+m).forEach(d=>{const p=S(d);a.style.display="none",y.appendChild(p)}),o+=m,o>=s.length?r.style.display="none":r.style.display="block",i.style.display="none",i.disabled=!0):(a.style.display="none",g.style.display="block",u.style.display="none",document.querySelector(".genre-form").style.display="none",r.style.display="none",i.style.display="block",i.disabled=!1),document.querySelectorAll(".my-library-movie-list-item").forEach(l=>{l.addEventListener("click",d=>{const f=d.currentTarget.dataset.id;f&&L(f)})})}async function k(e=!0){const t=h.getMovies();if(e&t.length===0){a.style.display="none",o=0,y.innerHTML="",g.style.display="block",r.style.display="none",u.style.display="none",document.querySelector(".genre-form").style.display="none",i.style.display="block",i.disabled=!1;return}else a.style.display="none",g.style.display="none",u.style.display="block",document.querySelector(".genre-form").style.display="block",i.style.display="none",i.disabled=!0;await M(t);for(const n of t.slice(o,o+m)){const s=S(n);y.appendChild(s)}o+=m,o>=t.length?r.style.display="none":r.style.display="block"}r.addEventListener("click",()=>{r.style.display="none",a.style.display="block",setTimeout(()=>{a.style.display="none",k(!1)},300)}),c.addEventListener("change",function(){const e=c.value;T(e)}),await w(),k()});
//# sourceMappingURL=library.js.map
